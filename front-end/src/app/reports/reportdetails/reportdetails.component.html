<div class="report-table-container">
    <div class="grid-row">
        <div class="grid-row__col grid-row__col--12">
            <div class="reports__btn-container">
                <div class="reports__tag-outer-wrapper">
                    <div id="button-container" class="reports__tag_wrapper">
                        <div *ngIf="filters" class="reports__tag_group">
                            <div *ngIf="filters.filterForms[0]">
                                <button class="btn reports__tag_btn reports__btn-search-filter">
                                    <span *ngFor="let formTag of filters.filterForms; let formIndex=index; let isLast=last">
                                        {{formTag}}
                                        <i class="fas fa-window-close reports__close-tag" (click)="removeTag('filterForms', formIndex)"></i>
                                        {{isLast ? '' : ' or '}}
                                    </span>
                                </button>
                            </div>
                            <div *ngIf="filters.filterReports[0]">
                                <button class="btn reports__tag_btn reports__btn-search-filter">
                                    <span *ngFor="let reportTag of filters.filterReports; let reportTypeIndex=index; let isLast=last">
                                        {{displayReportTypes(reportTag)}}
                                        <i class="fas fa-window-close reports__close-tag" (click)="removeTag('filterReports', reportTypeIndex)"></i>
                                        {{isLast ? '' : ' or '}}
                                    </span>
                                </button>
                            </div>
                            <div *ngIf="filters.filterAmendmentIndicators[0]">
                                <button class="btn reports__tag_btn reports__btn-search-filter">
                                    <span
                                        *ngFor="let amendmentIndicatorTag of filters.filterAmendmentIndicators; let amendmentIndicatorIndex=index; let isLast=last">
                                        {{displayAmendmentIndicator(amendmentIndicatorTag)}}
                                        <i class="fas fa-window-close reports__close-tag" (click)="removeTag('filterAmendmentIndicators', amendmentIndicatorIndex)"></i>
                                        {{isLast ? '' : ' or '}}
                                    </span>
                                </button>
                            </div>
                            <div *ngIf="filters.filterStatuss[0]">
                                <button class="btn reports__tag_btn reports__btn-search-filter">
                                    <span *ngFor="let status of filters.filterStatuss; let statusIndex=index; let isLast=last">
                                        {{displayStatusName(status)}}
                                        <i class="fas fa-window-close reports__close-tag" (click)="removeTag('filterStatuss', statusIndex)"></i>
                                        {{isLast ? '' : ' or '}}
                                    </span>
                                </button>
                            </div>
                            <div *ngIf="filters.filterCvgDateFrom && filters.filterCvgDateTo">
                                <button class="btn reports__tag_btn reports__btn-search-filter">
                                    {{filters.filterCvgDateFrom | date: 'MM/dd/yyyy'}} -
                                    {{filters.filterCvgDateTo | date: 'MM/dd/yyyy'}}
                                    <i class="fas fa-window-close reports__close-tag" (click)="removeTag('filterCvgDate')"></i>
                                </button>
                            </div>
                            <div *ngIf="filters.filterFiledDateFrom && filters.filterFiledDateTo">
                                <button class="btn reports__tag_btn reports__btn-search-filter">
                                    {{filters.filterFiledDateFrom | date: 'MM/dd/yyyy'}} -
                                    {{filters.filterFiledDateTo | date: 'MM/dd/yyyy'}}
                                    <i class="fas fa-window-close reports__close-tag" (click)="removeTag('filterFiledDate')"></i>
                                </button>
                            </div>
                            <div *ngIf="filters.filterDeletedDateFrom && filters.filterDeletedDateTo">
                                <button class="btn reports__tag_btn reports__btn-search-filter">
                                    {{filters.filterDeletedDateFrom | date: 'MM/dd/yyyy'}} -
                                    {{filters.filterDeletedDateTo | date: 'MM/dd/yyyy'}}
                                    <i class="fas fa-window-close reports__close-tag" (click)="removeTag('filterDeletedDate')"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="grid-row float-right">
        <div class="float-right forms__trx-item-range">
            {{determineItemRange()}} of {{config.totalItems}}
        </div>
    </div>
    <!--<table class="table table-striped table-hover table__sortable forms__trx-table">-->
    <table class="table table-striped table-hover table__sortable reports__table">
        <thead>
            <tr>
                <!--<th class="reports__table-checkbox">
                    <input   [(ngModel)]="allReportsSelected" type="checkbox"
                    (change)="changeAllReportsSelected()">
                </th>-->
                
                <th  *ngIf="isColumnVisible('form_type')" [class]="getSortClass('form_type')"
                    (click)="changeSortDirection('form_type')">Form
                </th>
                <th  *ngIf="isColumnVisible('status')" [class]="getSortClass('status')"
                    (click)="changeSortDirection('status')">Status
                </th>
                <th  *ngIf="isColumnVisible('fec_id')" [class]="getSortClass('fec_id')"
                    (click)="changeSortDirection('fec_id')">FEC ID
                </th>
                <th  *ngIf="isColumnVisible('amend_ind') && (!isRecycleBinViewActive())" [class]="getSortClass('amend_ind')"
                    (click)="changeSortDirection('amend_ind')">Amendment <br /> Indicator
                </th>
                <th  *ngIf="isColumnVisible('cvg_start_date')" [class]="getSortClass('cvg_start_date')"
                    (click)="changeSortDirection('cvg_start_date')">Coverage Date <br />Cycle
                </th>
                <th  *ngIf="isColumnVisible('report_type_desc')" [class]="getSortClass('report_type_desc')"
                    (click)="changeSortDirection('report_type_desc')">Report
                </th>
                <th  *ngIf="isColumnVisible('filed_date')" [class]="getSortClass('filed_date')"
                    (click)="changeSortDirection('filed_date')">Filed/Saved <br />Date Time
                </th>
                <th  *ngIf="(isColumnVisible('deleted_date') && isRecycleBinViewActive())" [class]="getSortClass('deleted_date')"
                    (click)="changeSortDirection('deleted_date')">Deleted Date <br />Time
                 </th>

            <!--    <th class="bulk_action">
                    <div  *ngIf="isReportViewActive()" class="btn-group" 
                            ngbDropdown role="group" aria-label="Action dropdown">
                        <button class="btn btn-sm btn-primary reports__bulk_action_btn" 
                            ngbDropdownToggle [disabled]="bulkActionDisabled">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                        <div id="forms__trx-dropdown-action" class="dropdown-menu" ngbDropdownMenu>
                            <button class="dropdown-item" (click)="printAllSelected()">
                                <i class="fas fa-print"></i>Print
                            </button>
                            <button class="dropdown-item" (click)="trashAllSelected()">
                                <i class="fas fa-trash"></i>Trash
                            </button>
                        </div>
                    </div> 
                    <div  *ngIf="isRecycleBinViewActive()">
                        <button class="btn btn-sm btn-primary reports__bulk_action_btn" 
                          (click)="deleteRecyleBin()"
                          [disabled]="bulkActionDisabled">
                          <i class="trash-icon"></i>
                        </button>
                    </div>                            
                </th> -->

            </tr>
        </thead>
        <tbody>
            <ng-container *ngFor="let report of reportsModel | paginate: config; let i = index">                
                <tr *ngIf="report.amend_show" [ngStyle]="{'background-color': 
                    (report.amend_ind === 'N' || report.amend_ind === 'T'
                    || report.amend_max === 'up' || report.amend_max === 'down') ? '' : '#D9EDF6'}">
                <!--<td >
                    <input [(ngModel)]="report.selected" type="checkbox" (click)="checkForMultiChecked($event)">
                </td>-->
                <td *ngIf="isColumnVisible('form_type')">{{report.form_type}}</td>
                <td *ngIf="isColumnVisible('status')">{{report.status}}</td>
                <td *ngIf="isColumnVisible('fec_id')">{{report.status === 'Filed' ? report.fec_id : '' }}</td>
                <!--<td *ngIf="isColumnVisible('amend_ind')">{{report.form_type !== 'F99' ? report.amend_ind : '' }}</td>-->
                <td *ngIf="isColumnVisible('amend_ind') && (!isRecycleBinViewActive())">
                    <div class="row td-amend">
                        {{(report.amend_ind === 'N' || report.amend_ind === 'T') ? '' : report.amend_ind}}
                        <div >
                            <i *ngIf="report.amend_max === 'down'" class="fas fa-angle-down amend-arrow" (click)="amendArrow(report)"></i>
                            <i *ngIf="report.amend_max === 'up'" class="fas fa-angle-up amend-arrow" (click)="amendArrow(report)"></i>
                        </div>
                    </div>
                </td>
                <td *ngIf="isColumnVisible('cvg_start_date')">
                    {{(report.form_type !== 'F99' && report.form_type !== 'F1M')? ( (report.cvg_start_date| date: 'MM/dd/yyyy') + " - "  + (report.cvg_end_date| date: 'MM/dd/yyyy' )) : '' }}
                </td>
                <td *ngIf="isColumnVisible('report_type_desc')">{{report.report_type_desc}}</td>
                <td *ngIf="isColumnVisible('filed_date')">
                    {{report.status === 'Filed'? (report.filed_date| date: 'MM/dd/yyyy @ hh:mm:ss a') : (report.last_update_date| date: 'MM/dd/yyyy @ hh:mm:ss a')}}
                </td>
                <td *ngIf="(isColumnVisible('deleted_date') && isRecycleBinViewActive())">
                    {{(report.deleteddate| date: 'MM/dd/yyyy @ hh:mm:ss a') }}
                </td>

                <td class="bulk_action" >
                    <div *ngIf="isRecycleBinViewActive()">
                        <button *ngIf="!authService.isReadOnly()" class="btn btn-sm btn-primary" (click)="restoreReport(report)">
                            <i class="undo-icon"></i>
                        </button>
                    </div>

                    <div 
                        *ngIf="isReportViewActive() && report.form_type !== 'F99' && report.status === 'Saved' && (report.amend_ind === 'N' || report.amend_ind === 'T')"
                        class="btn-group" ngbDropdown role="group" aria-label="Action dropdown">

                        <button class="btn btn-sm btn-primary" ngbDropdownToggle [disabled]="!bulkActionDisabled">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>


                        <div id="forms__trx-dropdown-action1" ngbDropdownToggle   class="dropdown-menu" ngbDropdownMenu>
                            <button *ngIf="!authService.isReadOnly()" class="dropdown-item" (click)="editReport(report)">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button *ngIf="authService.isReadOnly()" class="dropdown-item" (click)="viewReport(report)">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="dropdown-item" (click)="printReport(report)">
                                <i class="fas fa-print"></i> Print
                            </button>
                            <button  *ngIf="!authService.isReadOnly()" class="dropdown-item" (click)="uploadReport(report)">
                                <i class="fas fa-upload"></i> Upload
                            </button>
                            <button *ngIf="!authService.isReadOnly()" class="dropdown-item" (click)="trashReport(report)">
                                <i class="fas fa-trash"></i> Trash
                            </button>
                        </div>
                    </div>

                    <div 
                        *ngIf="isReportViewActive() && report.form_type !== 'F99' && report.status !== 'Filed' && !(report.amend_ind === 'N' || report.amend_ind === 'T')"
                        class="btn-group" ngbDropdown role="group" aria-label="Action dropdown">

                        <button class="btn btn-sm btn-primary" ngbDropdownToggle [disabled]="!bulkActionDisabled">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>

                        <div id="forms__trx-dropdown-action5" ngbDropdownToggle   class="dropdown-menu" ngbDropdownMenu>
                            <button *ngIf="(report.amend_max === 'up' || report.amend_max === 'down')
                             && !authService.isReadOnly()" class="dropdown-item"
                                    (click)="editReport(report)">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button *ngIf="authService.isReadOnly()" class="dropdown-item" (click)="viewReport(report)">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="dropdown-item" (click)="printReport(report)">
                                <i class="fas fa-print"></i> Print
                            </button>                            
                            <button *ngIf="!authService.isReadOnly()" class="dropdown-item" (click)="uploadReport(report)">
                                <i class="fas fa-upload"></i> Upload
                            </button>
                            <button *ngIf="(report.amend_max === 'up' || report.amend_max === 'down') &&
                                !authService.isReadOnly()" class="dropdown-item" (click)="trashReport(report)">
                                <i class="fas fa-trash"></i> Trash
                            </button>
                        </div>
                    </div>

                    <div 
                        *ngIf="isReportViewActive() && report.form_type !== 'F99' && report.status === 'Filed'"
                        class="btn-group" ngbDropdown role="group" aria-label="Action dropdown">

                        <button class="btn btn-sm btn-primary" ngbDropdownToggle [disabled]="!bulkActionDisabled">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                        <div id="forms__trx-dropdown-action2" class="dropdown-menu" ngbDropdownMenu>
                            <button *ngIf="report.amend_ind === 'N' || report.amend_max === 'up' || report.amend_max === 'down'" class="dropdown-item"  (click)="viewReport(report)">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button  *ngIf="report.amend_ind === 'N' ||report.amend_max === 'up' || report.amend_max === 'down' && !authService.isReadOnly()" class="dropdown-item" (click)="amendReport(report)">
                                <i class="fas fa-edit"></i> Amend
                            </button>
                            <button class="dropdown-item" (click)="downloadReport(report)">
                                <i class="fas fa-download"></i> Download
                            </button>
                            <!--<button class="dropdown-item" (click)="printReport(report)">
                                <i class="fas fa-print"></i> Print
                            </button> -->
                        </div>
                    </div>

                    <div 
                        *ngIf="isReportViewActive() && report.form_type === 'F99' && report.status === 'Filed'"
                        class="btn-group" ngbDropdown role="group" aria-label="Action dropdown">

                        <button class="btn btn-sm btn-primary" ngbDropdownToggle [disabled]="!bulkActionDisabled">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                        <div id="forms__trx-dropdown-action3" class="dropdown-menu" ngbDropdownMenu>
                            <button class="dropdown-item" *ngIf="report.status === 'Filed'" (click)="viewReport(report)">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="dropdown-item" (click)="downloadReport(report)">
                                <i class="fas fa-download"></i> Download
                            </button>
                          <!---  <button class="dropdown-item" (click)="printReport(report)">
                                <i class="fas fa-print"></i> Print
                            </button> -->
                        </div>
                    </div>

                    <div 
                        *ngIf="isReportViewActive() && report.form_type === 'F99' && report.status !== 'Filed'"
                        class="btn-group" ngbDropdown role="group" aria-label="Action dropdown">

                        <button class="btn btn-sm btn-primary" ngbDropdownToggle [disabled]="!bulkActionDisabled">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                        <div id="forms__trx-dropdown-action4" class="dropdown-menu" ngbDropdownMenu>
                            <button *ngIf="!authService.isReadOnly()" class="dropdown-item" (click)="editReport(report)">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="dropdown-item" (click)="printReport(report)">
                                <i class="fas fa-print"></i> Print
                            </button>                            
                            <button *ngIf="!authService.isReadOnly()" class="dropdown-item" (click)="uploadReport(report)">
                                <i class="fas fa-upload"></i> Upload
                            </button>
                            <button *ngIf="!authService.isReadOnly()" class="dropdown-item" (click)="trashReport(report)">
                                <i class="fas fa-trash"></i> Trash
                            </button>
                        </div>

                    </div>
                </td>

            </tr>
            </ng-container>
        </tbody>
    </table>
    <div *ngIf="showPagination()" class="d-flex justify-content-center Report-table-pagination-container">
        <pagination-controls [id]="config.id" (pageChange)="getPage($event)">
        </pagination-controls>
    </div>

    <div bsModal #columnOptionsModal="bs-modal" class="modal fade column-options-modal" tabindex="-1" role="dialog"
        aria-labelledby="dialog-sizes-name1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title pull-left">Column Options</h4>
                    <button aria-label="Close" class="close btn btn-link" type="button" (click)="cancelColumnOptions()">
                        <span aria-hidden="true">Ã—</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <div class="row">
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('form_type').checked"
                                            (change)="toggleVisibility('form_type', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('form_type').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('form_type').disabled}">
                                            Form
                                        </span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('status').checked"
                                            (change)="toggleVisibility('status', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('status').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('status').disabled}">
                                            Status
                                        </span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('fec_id').checked"
                                            (change)="toggleVisibility('fec_id', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('fec_id').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('fec_id').disabled}">
                                            FEC ID
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('amend_ind').checked"
                                            (change)="toggleVisibility('amend_ind', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('amend_ind').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('amend_ind').disabled}">
                                            Amendment Indicator
                                        </span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('cvg_start_date').checked"
                                            (change)="toggleVisibility('cvg_start_date', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('cvg_start_date').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('cvg_start_date').disabled}">
                                            Coverage Date Cycle
                                        </span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('report_type_desc').checked"
                                            (change)="toggleVisibility('report_type_desc', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('report_type_desc').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('report_type_desc').disabled}">
                                            Report
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('last_update_date').checked"
                                            (change)="toggleVisibility('last_update_date', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('last_update_date').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('last_update_date').disabled}">
                                            Filed Date
                                        </span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md">
                                <div class="checkbox">
                                    <label>
                                        <input [(ngModel)]="getSortableColumn('deleted_date').checked"
                                            (change)="toggleVisibility('deleted_date', $event)" type="checkbox"
                                            [disabled]="getSortableColumn('deleted_date').disabled">
                                        <span
                                            [ngClass]="{'disabled-column-option':getSortableColumn('deleted_date').disabled}">
                                            Deleted Date
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="btn-cancel" class="btn btn-modal-footer btn-right"
                        (click)="cancelColumnOptions()">
                        Cancel
                    </button>
                    <button type="button" class="btn btn-secondary btn-modal-footer btn-right"
                        (click)="saveColumnOptions()">
                        Save
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
